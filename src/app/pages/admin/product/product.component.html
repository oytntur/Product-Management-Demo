<div class="container-fluid py-4">
  @if (product(); as product) {
  <div class="row">
    <!-- Ürün Başlığı -->
    <div class="col-12 mb-4">
      <div class="card shadow-sm">
        <div class="card-header bg-primary text-white">
          <h1 class="card-title h3 mb-0">
            <i class="fas fa-box me-2"></i>
            {{ product.name }}
          </h1>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-6">
              <div class="product-status mb-3">
                <span
                  class="badge fs-6"
                  [class]="product.discontinued ? 'bg-danger' : 'bg-success'"
                >
                  {{ product.discontinued ? 'Pasif' : 'Aktif' }}
                </span>
              </div>
            </div>
            <div class="col-md-6 text-md-end">
              <h2 class="text-primary mb-0">${{ product.unitPrice }}</h2>
              <small class="text-muted">{{ product.quantityPerUnit }} başına</small>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Ürün Detayları -->
    <div class="col-lg-8 mb-4">
      <div class="card shadow-sm h-100">
        <div class="card-header">
          <h5 class="card-title mb-0">
            <i class="fas fa-info-circle me-2"></i>
            Ürün Bilgileri
          </h5>
        </div>
        <div class="card-body">
          <div class="row g-3">
            <div class="col-sm-6">
              <div class="detail-item">
                <label class="detail-label">Ürün ID</label>
                <div class="detail-value">{{ product.id }}</div>
              </div>
            </div>
            <div class="col-sm-6">
              <div class="detail-item">
                <label class="detail-label">Tedarikçi ID</label>
                <div class="detail-value">{{ product.supplierId }}</div>
              </div>
            </div>
            <div class="col-sm-6">
              <div class="detail-item">
                <label class="detail-label">Kategori ID</label>
                <div class="detail-value">{{ product.categoryId }}</div>
              </div>
            </div>
            <div class="col-sm-6">
              <div class="detail-item">
                <label class="detail-label">Birim Başına Miktar</label>
                <div class="detail-value">{{ product.quantityPerUnit }}</div>
              </div>
            </div>
            <div class="col-sm-6">
              <div class="detail-item">
                <label class="detail-label">Birim Fiyat</label>
                <div class="detail-value text-primary fw-bold">${{ product.unitPrice }}</div>
              </div>
            </div>
            <div class="col-sm-6">
              <div class="detail-item">
                <label class="detail-label">Yeniden Sipariş</label>
                <div class="detail-value">{{ product.reorderLevel }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Stok Durumu -->
    <div class="col-lg-4 mb-4">
      <div class="card shadow-sm h-100">
        <div class="card-header">
          <h5 class="card-title mb-0">
            <i class="fas fa-warehouse me-2"></i>
            Stok Durumu
          </h5>
        </div>
        <div class="card-body">
          <div class="inventory-stats">
            <!-- DevExtreme Progress Bar ile stoktaki birimler -->
            <div class="stat-item mb-3">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <span class="stat-label">Stoktaki Ürün</span>
                <span
                  class="badge"
                  [class]="
                    product.unitsInStock <= product.reorderLevel
                      ? 'bg-warning text-dark'
                      : 'bg-success'
                  "
                >
                  {{ product.unitsInStock }}
                </span>
              </div>
              <dx-progress-bar
                [min]="0"
                [max]="(product.unitsInStock + product.reorderLevel) * 2"
                [value]="product.unitsOnOrder"
              ></dx-progress-bar>
            </div>

            <!-- Siparişteki birimler -->
            <div class="stat-item mb-3">
              <div class="d-flex justify-content-between align-items-center">
                <span class="stat-label">Siparişteki Ürün</span>
                <span class="badge bg-info">{{ product.unitsOnOrder }}</span>
              </div>
            </div>

            <!-- Yeniden sipariş uyarısı -->
            @if (product.unitsInStock <= product.reorderLevel) {
            <div class="alert alert-warning d-flex align-items-center">
              <i class="fas fa-exclamation-triangle me-2"></i>
              <div>
                <strong>Düşük Stok Uyarısı!</strong><br />
                <small>Stok seviyesi yeniden sipariş eşiğinde veya altında.</small>
              </div>
            </div>
            }

            <!-- Toplam erişilebilir -->
            <div class="stat-summary">
              <div class="d-flex justify-content-between">
                <span class="fw-bold">Toplam Erişilebilir:</span>
                <span class="fw-bold text-primary">{{
                  product.unitsInStock + product.unitsOnOrder
                }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- DevExtreme butonları ile hızlı işlemler -->
    <div class="col-12">
      <div class="card shadow-sm">
        <div class="card-header">
          <h5 class="card-title mb-0">
            <i class="fas fa-tools me-2"></i>
            Hızlı İşlemler
          </h5>
        </div>
        <div class="card-body">
          <div class="d-flex flex-wrap gap-2">
            <dx-button
              text="Ürünü Düzenle"
              type="normal"
              stylingMode="contained"
              icon="edit"
              [width]="140"
            ></dx-button>

            <dx-button
              text="Stok Ekle"
              type="success"
              stylingMode="contained"
              icon="plus"
              [width]="120"
            ></dx-button>

            <dx-button
              text="Siparişleri Gör"
              type="normal"
              stylingMode="outlined"
              icon="cart"
              [width]="130"
            ></dx-button>

            <dx-button
              text="Analizler"
              type="normal"
              stylingMode="text"
              icon="chart"
              [width]="110"
            ></dx-button>

            <dx-button
              [text]="product.discontinued ? 'Tekrar Aktifleştir' : 'Pasifleştir'"
              [type]="product.discontinued ? 'success' : 'danger'"
              stylingMode="outlined"
              [icon]="product.discontinued ? 'activefolder' : 'remove'"
              [width]="130"
            ></dx-button>
          </div>
        </div>
      </div>
    </div>
  </div>
  } @else { @if(isLoading()) {
  <div class="row">
    <div class="col-12">
      <div class="card shadow-sm">
        <div class="card-body text-center py-5">
          <dx-load-indicator [visible]="true" [height]="60" [width]="60"></dx-load-indicator>
          <p class="mt-3 text-muted">Ürün detayları yükleniyor...</p>
        </div>
      </div>
    </div>
  </div>
  } @else {
  <div class="row">
    <div class="col-12">
      <div class="card shadow-sm">
        <div class="card-body text-center py-5">
          <i class="fas fa-box-open fa-3x text-muted mb-3"></i>
          <h4 class="text-muted">Ürün seçilmedi</h4>
          <p class="text-muted">Detayları görmek için bir ürün seçin.</p>
          <dx-button
            text="Ürünleri İncele"
            type="default"
            stylingMode="contained"
            icon="bulletlist"
          ></dx-button>
        </div>
      </div>
    </div>
  </div>
  } }
</div>
